<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flash Sale - Highlands Coffee</title>
    <link rel="stylesheet" href="styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .flash-sale-page {
        background: #f8f4f0;
        min-height: 100vh;
        padding: 20px 0;
      }

      .flash-header {
        text-align: center;
        margin-bottom: 30px;
      }

      .flash-title {
        background: linear-gradient(45deg, #dc3545, #ff6b35);
        color: white;
        padding: 15px 40px;
        border-radius: 25px;
        display: inline-block;
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
      }

      .flash-subtitle {
        color: #666;
        font-size: 14px;
      }

      .coupon-section {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 30px 0;
        flex-wrap: wrap;
      }

      .coupon-item {
        background: white;
        border: 2px solid #dc3545;
        border-radius: 10px;
        padding: 15px 20px;
        text-align: center;
        min-width: 200px;
      }

      .coupon-amount {
        background: #dc3545;
        color: white;
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: bold;
        margin-bottom: 10px;
        display: inline-block;
      }
      .container-flash {
        background: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }
      .flash-products-container {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
        border-radius: 10px;
      }

      @media (max-width: 1200px) {
        .flash-products-container {
          grid-template-columns: repeat(3, 1fr);
        }
      }

      @media (max-width: 768px) {
        .flash-products-container {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 480px) {
        .flash-products-container {
          grid-template-columns: 1fr;
        }
      }

      .flash-product-card {
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
        position: relative;
        border: 1px solid #eee;
      }

      .flash-product-card:hover {
        transform: translateY(-5px);
      }

      .discount-circle {
        position: absolute;
        top: 10px;
        left: 10px;
        background: #dc3545;
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 12px;
        z-index: 2;
      }

      .pagination-container {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin: 40px 0;
        gap: 8px;
        padding-right: 20px;
      }

      .pagination-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid #ddd;
        background: white;
        color: #666;
        cursor: pointer;
        font-weight: 500;
        font-size: 14px;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .pagination-btn:hover {
        border-color: #b22a2e;
        color: #b22a2e;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }

      .pagination-btn.active {
        background: #b22a2e;
        border-color: #b22a2e;
        color: white;
        box-shadow: 0 4px 12px rgba(178, 42, 46, 0.3);
      }

      .pagination-btn:disabled {
        background: #f8f8f8;
        border-color: #e0e0e0;
        color: #ccc;
        cursor: not-allowed;
        transform: none;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      }

      .pagination-btn:disabled:hover {
        transform: none;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      }
    </style>
  </head>
  <body>
    <div id="header-container"></div>

    <main class="flash-sale-page">
      <div class="container">
        <div class="flash-header">
          <div class="flash-title">⚡ DEAL HOT HÔM NAY ⚡</div>
          <p class="flash-subtitle">Sản phẩm sẽ trở về giá gốc khi hết giờ</p>

          <div class="countdown-timer">
            <div class="time-unit">
              <span class="time-value" id="hours">23</span>
              <span class="time-label">Giờ</span>
            </div>
            <div class="time-unit">
              <span class="time-value" id="minutes">59</span>
              <span class="time-label">Phút</span>
            </div>
            <div class="time-unit">
              <span class="time-value" id="seconds">59</span>
              <span class="time-label">Giây</span>
            </div>
          </div>
        </div>

        <section class="discount-coupons">
          <div class="coupons-container">
            <div class="coupon-card-flash">
              <div class="coupon-left">
                <div class="coupon-badge">
                  <span class="coupon-text">TẶNG</span>
                  <span class="coupon-amount">50K</span>
                </div>
              </div>
              <div class="coupon-right">
                <div class="coupon-info">
                  <h3 class="coupon-title">NHẬP MÃ: TANG50K</h3>
                  <p class="coupon-desc">- Giảm 50K cho hóa đơn từ</p>
                  <p class="coupon-min">199K</p>
                </div>
                <div class="coupon-actions">
                  <button class="btn-copy-code" onclick="copyCode('TANG50K')">
                    Sao chép mã
                  </button>
                  <button
                    class="btn-conditions"
                    onclick="showConditions('TANG50K')"
                  >
                    Điều kiện
                  </button>
                </div>
              </div>
            </div>

            <div class="coupon-card-flash">
              <div class="coupon-left">
                <div class="coupon-badge">
                  <span class="coupon-text">TẶNG</span>
                  <span class="coupon-amount">35K</span>
                </div>
              </div>
              <div class="coupon-right">
                <div class="coupon-info">
                  <h3 class="coupon-title">NHẬP MÃ: TANG35K</h3>
                  <p class="coupon-desc">- Giảm 35K cho hóa đơn từ</p>
                  <p class="coupon-min">149K</p>
                </div>
                <div class="coupon-actions">
                  <button class="btn-copy-code" onclick="copyCode('TANG35K')">
                    Sao chép mã
                  </button>
                  <button
                    class="btn-conditions"
                    onclick="showConditions('TANG35K')"
                  >
                    Điều kiện
                  </button>
                </div>
              </div>
            </div>

            <div class="coupon-card-flash">
              <div class="coupon-left">
                <div class="coupon-badge">
                  <span class="coupon-text">TẶNG</span>
                  <span class="coupon-amount">20K</span>
                </div>
              </div>
              <div class="coupon-right">
                <div class="coupon-info">
                  <h3 class="coupon-title">NHẬP MÃ: TANG20K</h3>
                  <p class="coupon-desc">- Giảm 20K cho hóa đơn từ</p>
                  <p class="coupon-min">129K</p>
                </div>
                <div class="coupon-actions">
                  <button class="btn-copy-code" onclick="copyCode('TANG20K')">
                    Sao chép mã
                  </button>
                  <button
                    class="btn-conditions"
                    onclick="showConditions('TANG20K')"
                  >
                    Điều kiện
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>

        <div class="container-flash">
          <div class="flash-products-container" id="flashProductsContainer">
            <!-- Products will be rendered here -->
          </div>

          <div class="pagination-container" id="paginationContainer">
            <!-- Pagination will be rendered here -->
          </div>
        </div>
      </div>
    </main>

    <div id="footer-container"></div>

    <script src="components.js"></script>
    <script src="script.js"></script>
    <script>
      // Pagination variables
      let currentPage = 1;
      const itemsPerPage = 16;
      let totalPages = 1;

      document.addEventListener("DOMContentLoaded", function () {
        renderFlashSaleProducts();
        renderPagination();
        startCountdown();
      });

      function renderFlashSaleProducts() {
        const container = document.getElementById("flashProductsContainer");
        if (!container || !window.mockData) return;

        const flashSaleProducts = window.mockData.flashSale;
        totalPages = Math.ceil(flashSaleProducts.length / itemsPerPage);

        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const currentProducts = flashSaleProducts.slice(startIndex, endIndex);

        container.innerHTML = currentProducts
          .map(
            (product) => `
                <div class="flash-product-card" onclick="goToProduct('${
                  product.id
                }')">
                    <div class="discount-circle">-${product.discount}%</div>
                    <div class="product-image">
                        <img src="${product.image}" alt="${
              product.name
            }" style="width: 100%; height: 200px; object-fit: cover;">
                    </div>
                    <div class="product-info" style="padding: 15px;">
                        <p class="product-category" style="color: #666; font-size: 12px; margin-bottom: 5px;">${
                          product.category
                        }</p>
                        <h3 style="font-size: 14px; margin-bottom: 10px; height: 40px; overflow: hidden;">${
                          product.name
                        }</h3>
                        <div class="product-price" style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <span class="current-price" style="color: #dc3545; font-weight: bold;">${formatCurrency(
                                  product.currentPrice
                                )}</span><br>
                                <span class="original-price" style="text-decoration: line-through; color: #999; font-size: 12px;">${formatCurrency(
                                  product.originalPrice
                                )}</span>
                            </div>
                            <button class="btn-add-cart flash" onclick="event.stopPropagation(); addToCart('${
                              product.id
                            }')" style="background: #dc3545; color: white; border: none; width: 30px; height: 30px; border-radius: 50%; cursor: pointer;">+</button>
                        </div>
                        <div class="stock-info" style="margin-top: 10px;">
                            <span style="color: #666; font-size: 12px;">${
                              product.stockSold
                            } sản phẩm đã bán</span>
                        </div>
                    </div>
                </div>
            `
          )
          .join("");
      }

      function renderPagination() {
        const container = document.getElementById("paginationContainer");
        if (!container) return;

        let paginationHTML = "";

        // Page numbers only (no previous/next buttons to match the image)
        for (let i = 1; i <= totalPages; i++) {
          paginationHTML += `<button class="pagination-btn ${
            i === currentPage ? "active" : ""
          }" onclick="changePage(${i})">${i}</button>`;
        }

        // Next button (arrow pointing right)
        if (currentPage < totalPages) {
          paginationHTML += `<button class="pagination-btn" onclick="changePage(${
            currentPage + 1
          })">›</button>`;
        }

        container.innerHTML = paginationHTML;
      }

      function changePage(page) {
        if (page < 1 || page > totalPages) return;
        currentPage = page;
        renderFlashSaleProducts();
        renderPagination();

        // Scroll to top of products
        document
          .getElementById("flashProductsContainer")
          .scrollIntoView({ behavior: "smooth" });
      }

      function goToProduct(productId) {
        window.location.href = `product-detail.html?id=${productId}`;
      }

      function addToCart(productId) {
        if (window.cart && window.mockData) {
          const product = window.mockData.flashSale.find(
            (p) => p.id === productId
          );
          if (product) {
            window.cart.addItem(product.id, product);
          }
        }
      }

      function startCountdown() {
        // Simple countdown timer
        setInterval(() => {
          const hoursEl = document.getElementById("hours");
          const minutesEl = document.getElementById("minutes");
          const secondsEl = document.getElementById("seconds");

          let seconds = parseInt(secondsEl.textContent);
          let minutes = parseInt(minutesEl.textContent);
          let hours = parseInt(hoursEl.textContent);

          seconds--;
          if (seconds < 0) {
            seconds = 59;
            minutes--;
            if (minutes < 0) {
              minutes = 59;
              hours--;
              if (hours < 0) {
                hours = 23;
              }
            }
          }

          hoursEl.textContent = hours.toString().padStart(2, "0");
          minutesEl.textContent = minutes.toString().padStart(2, "0");
          secondsEl.textContent = seconds.toString().padStart(2, "0");
        }, 1000);
      }
    </script>
  </body>
</html>
